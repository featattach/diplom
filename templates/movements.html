{% extends "base.html" %}
{% block title %}Перемещения — Система учёта оборудования{% endblock %}
{% block content %}
<h1 class="card-title">Журнал перемещений и списаний оборудования</h1>
<p class="card-subtitle">На странице представлен журнал, фиксирующий все факты перемещений оборудования между офисами, сотрудниками и зонами хранения. Также отображаются записи о списании техники с указанием причины.</p>
<div class="table-responsive">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Дата</th>
                <th>Тип события</th>
                <th>Оборудование</th>
                <th>Комментарий</th>
                <th>Изменения (было → стало)</th>
            </tr>
        </thead>
        <tbody>
            {% for e in events %}
            <tr>
                <td>{{ e.created_at.strftime('%Y-%m-%d %H:%M') if e.created_at else '—' }}</td>
                <td><span class="badge bg-info">{{ event_type_label(e.event_type) }}</span></td>
                <td>{% if e.asset %}<a href="{{ request.url_for('asset_detail', asset_id=e.asset.id) }}">{{ e.asset.name }}</a>{% else %}—{% endif %}</td>
                <td>{{ e.description or '—' }}</td>
                <td>
                    {% if e.changes_list %}
                    <ul class="list-unstyled mb-0 small">
                        {% for ch in e.changes_list %}
                        <li><strong>{{ ch.field_label }}</strong>: <span class="text-muted">{{ ch.old }}</span> → <span>{{ ch.new }}</span></li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    —
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr><td colspan="5" class="text-muted">Нет записей</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
